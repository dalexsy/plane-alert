<div
  class="window-view-overlay"
  [ngClass]="{ daytime: isDaytime() }"
  (contextmenu)="$event.stopPropagation()"
  [style.background]="skyBackground"
>
  <!-- Sky background with clouds -->
  <app-sky-background
    [windowCloudUrl]="windowCloudUrl"
    [cloudFilter]="cloudFilter"
    [cloudBacklightClass]="cloudBacklightClass"
  ></app-sky-background>

  <!-- Rain overlay -->
  <app-rain-overlay></app-rain-overlay>
  <!-- Compass labels with roof background -->
  <app-compass-labels
    [compassBackground]="compassBackground"
    [chimneyBackground]="chimneyBackground"
  ></app-compass-labels>

  <!-- Marker lines for balcony/streetside boundaries -->
  <app-marker-lines [markerPlanes]="getMarkerPlanes()"></app-marker-lines>

  <!-- Altitude bands for visual reference -->
  <app-altitude-bands [altitudeTicks]="altitudeTicks"></app-altitude-bands>

  <!-- Dimmed regions outside marker spans -->
  <app-dim-overlay [dimSegments]="dimSegments"></app-dim-overlay>

  <!-- Celestial objects (sun/moon) -->
  <app-celestial-objects
    [celestialObjects]="getCelestialObjects()"
    [isDaytime]="isDaytime()"
  ></app-celestial-objects>
  <!-- Aircraft container with planes and trails -->
  <app-aircraft-container
    [aircraftPlanes]="getAircraftPlanes()"
    [highlightedPlaneIcao]="highlightedPlaneIcao"
    (selectPlane)="handlePlaneSelection($event)"
  ></app-aircraft-container>
</div>
